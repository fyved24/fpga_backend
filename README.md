# FPAG bakend

## 架构

```
                                         +-------------------------+                                             +-------------------------+
                                         |                         |                                             |                         |
                              +----------+                         +------+                                      | websocket server        |
                              |          |    main process         |      |                 +------------------> |                         |
                              |          |                         |      |                 |                    |                         |
                              |          +-------------------------+      |                 |                    +-------------+-----------+
                              |                                           |                 |                                  |
                              |                                           |                 |                                  |
                 +------------+----------+                   +------------+----+            |                                  |
                 |       thread          |                   |    thread       |            |                                  |
+--------+       |     serial listener   |     +--------+    |                 |            |                                  |
|       +---------------------+--------------> | queue  +--->+  db writer      |            |                                  v
| serial |       |            |          |     +--------+    |                 |            |
+--------+       +--------+--------+-----+                   +-----------------+    +-------+-------+                    +------------------+
                          |   |    |                                                |               |                    |                  |
                          |  hook  +----------------------------------------------->+ ws client     |                    |                  |
                          +---+----+                                                |               |                    | ws client        |
                              v                                                     +---------------+                    |                  |
                                                                                                                         +------------------+

```
